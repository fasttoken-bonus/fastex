"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4192],{95181:function(e,l,o){o.r(l),o.d(l,{default:function(){return components_Overlays}});var r,t,u=o(52322),n=o(1406),a=o(2784),d=o(4326),i=o(61840),s=((r={}).OnLoad="ON_LOAD",r.CustomerGroup="CUSTOMER_GROUP",r.ScrollPosition="SCROLL_POSITION",r.Delay="DELAY",r),c=((t={}).And="AND",t.Or="OR",t),v=o(18723),y=o(80616),p=o(60396),components_Overlays=function(e){var l;let{overlays:o,layouts:r}=e,{isGuest:t,isLoadingUser:f,user:O}=(0,v.P)(),m=(0,a.useRef)({}),[h,w]=(0,a.useState)(),g=(0,a.useCallback)(e=>{w(l=>new Set([...Array.from(l||[]),...e]))},[]);(0,a.useEffect)(()=>{if(!f){m.current={};let e=[];null==o||o.forEach(l=>{var o,r,u;(null===(o=l.rules)||void 0===o?void 0:o.length)&&(null===(u=l.triggers)||void 0===u?void 0:null===(r=u.published)||void 0===r?void 0:r.length)&&(!l.showOnlyOnce||"true"!==p.Z.get("".concat(y.Bf.OpenedOverlays,":").concat(l.layout.id)))&&l.rules.forEach(o=>{if(!o.conditions){e.push(l.layout.id);return}let r=o.conditionOperator===c.And?"every":"some",u={},n=o.conditions[r](e=>{var l,o,r;switch(e.type){case s.CustomerGroup:return(null===(l=e.params)||void 0===l?void 0:l.value).some(e=>{var l,o;return(null==O?void 0:null===(l=O.customerGroup)||void 0===l?void 0:l.uuid)===e||null===e&&(t||(null==O?void 0:null===(o=O.customerGroup)||void 0===o?void 0:o.code)==="guest")});case s.ScrollPosition:return u.scroll=null===(o=e.params)||void 0===o?void 0:o.value,!0;case s.Delay:return u.delay=null===(r=e.params)||void 0===r?void 0:r.value,!0}});if(n){if(u.scroll){if(+u.scroll<=window.scrollY)return e.push(l.layout.id);m.current[u.scroll]={id:l.layout.id,delay:u.delay}}else u.delay?setTimeout(()=>{g([l.layout.id])},u.delay):e.push(l.layout.id)}})}),g(e)}},[o,t,O,f,g]),(0,a.useEffect)(()=>{let onScroll=()=>{let e=Object.entries(m.current).reduce((e,l)=>{let[o,r]=l;return+o<=window.scrollY?(delete m.current[o],r.delay)?(setTimeout(()=>{g([r.id])},r.delay),e):[...e,r.id]:e},[]);g(e)};return document.addEventListener("scroll",onScroll),()=>window.removeEventListener("scroll",onScroll)},[o,g]),(0,d.ZP)({onEvent:e=>{let{key:l,payload:o}=e;l===i.g5.openOverlay&&(null==o?void 0:o.layoutId)&&g([o.layoutId]),l===i.g5.closeOverlay&&o.layoutId&&w(e=>(null==e||e.delete(o.layoutId),new Set(e)))}});let E=(0,a.useCallback)(e=>{e.target===e.currentTarget&&w(void 0)},[]);return(0,u.jsx)(u.Fragment,{children:null===(l=Array.from(h||[]))||void 0===l?void 0:l.map(e=>(null==r?void 0:r[e])&&(0,u.jsx)(n.t,{layout:r[e],onClick:E,layoutProps:{"data-layout-id":e}},e))})}}}]);